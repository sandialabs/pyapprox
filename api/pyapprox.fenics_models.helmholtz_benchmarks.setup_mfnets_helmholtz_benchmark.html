

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>setup_mfnets_helmholtz_benchmark &mdash; PyApprox 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"V": ["{\\boldsymbol{#1}}", 1], "mean": ["{\\mathbb{E}\\left[#1\\right]}", 1], "var": ["{\\mathbb{V}\\left[#1\\right]}", 1], "argmin": "{\\mathrm{argmin}}", "rv": "z", "reals": "\\mathbb{R}", "pdf": "\\rho", "rvdom": "\\Gamma", "coloneqq": "\\colon=", "norm": ["{\\lVert #1 \\rVert}", 1], "argmax": ["\\operatorname{argmax}"], "covar": ["\\mathbb{C}\\text{ov}\\left[#1,#2\\right]", 2], "corr": ["\\mathbb{C}\\text{or}\\left[#1,#2\\right]", 2], "ai": "\\alpha", "bi": "\\beta", "dx": ["\\;\\mathrm{d}#1", 1]}}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HelmholtzBasis" href="pyapprox.fenics_models.helmholtz_benchmarks.HelmholtzBasis.html" />
    <link rel="prev" title="setup_helmholtz_model" href="pyapprox.fenics_models.helmholtz_benchmarks.setup_helmholtz_model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PyApprox
          

          
            
            <img src="../_static/pyapprox-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_tutorials/index.html">PyApprox Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmarks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption"><span class="caption-text">User Reference Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_reference_guide.html">User Reference Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Reference Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Developer Reference Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.approximate">pyapprox.approximate Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.sensitivity_analysis">pyapprox.sensitivity_analysis Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.quadrature">pyapprox.quadrature Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.benchmarks.benchmarks">pyapprox.benchmarks.benchmarks Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.benchmarks.sensitivity_benchmarks">pyapprox.benchmarks.sensitivity_benchmarks Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.fenics_models.advection_diffusion_wrappers">pyapprox.fenics_models.advection_diffusion_wrappers Module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../modules.html#module-pyapprox.fenics_models.helmholtz_benchmarks">pyapprox.fenics_models.helmholtz_benchmarks Module</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../modules.html#id19">Functions</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pyapprox.fenics_models.helmholtz_benchmarks.generate_helmholtz_bases.html">generate_helmholtz_bases</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyapprox.fenics_models.helmholtz_benchmarks.get_helmholtz_speaker_boundary_conditions.html">get_helmholtz_speaker_boundary_conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyapprox.fenics_models.helmholtz_benchmarks.get_speaker_boundary_segment_indices.html">get_speaker_boundary_segment_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyapprox.fenics_models.helmholtz_benchmarks.helmholtz_basis.html">helmholtz_basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyapprox.fenics_models.helmholtz_benchmarks.plot_mfnets_helmholtz_benchmark_data.html">plot_mfnets_helmholtz_benchmark_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyapprox.fenics_models.helmholtz_benchmarks.setup_helmholtz_model.html">setup_helmholtz_model</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">setup_mfnets_helmholtz_benchmark</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules.html#id20">Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.multivariate_polynomials">pyapprox.multivariate_polynomials Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.bayesian_inference.markov_chain_monte_carlo">pyapprox.bayesian_inference.markov_chain_monte_carlo Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.optimal_experimental_design">pyapprox.optimal_experimental_design Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.models.wrappers">pyapprox.models.wrappers Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.models.async_model">pyapprox.models.async_model Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#module-pyapprox.control_variate_monte_carlo">pyapprox.control_variate_monte_carlo Module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyApprox</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../modules.html">Developer Reference Guide</a> &raquo;</li>
        
      <li>setup_mfnets_helmholtz_benchmark</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/pyapprox.fenics_models.helmholtz_benchmarks.setup_mfnets_helmholtz_benchmark.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setup-mfnets-helmholtz-benchmark">
<h1>setup_mfnets_helmholtz_benchmark<a class="headerlink" href="#setup-mfnets-helmholtz-benchmark" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="pyapprox.fenics_models.helmholtz_benchmarks.setup_mfnets_helmholtz_benchmark">
<code class="sig-prename descclassname">pyapprox.fenics_models.helmholtz_benchmarks.</code><code class="sig-name descname">setup_mfnets_helmholtz_benchmark</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh_resolution</span><span class="o">=</span><span class="default_value">51</span></em>, <em class="sig-param"><span class="n">noise_std</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyapprox/fenics_models/helmholtz_benchmarks.html#setup_mfnets_helmholtz_benchmark"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyapprox.fenics_models.helmholtz_benchmarks.setup_mfnets_helmholtz_benchmark" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the multi-fidelity benchmark used to combine helmholtz data.</p>
<div class="figure align-center" id="id1">
<img alt="../_images/helmholtz-octagon.png" src="../_images/helmholtz-octagon.png" />
<p class="caption"><span class="caption-text">Experimental configuration. Speaker cones (green speakers), speaker cabinets (black segments), scatterer (red and blue circles).</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>For a fixed angular velocity <span class="math notranslate nohighlight">\(\omega = 2\pi f\)</span>, the acoustic pressure <span class="math notranslate nohighlight">\(u\)</span> is modeled using the (real) Helmholtz equation defined on an open regular octagon domain <span class="math notranslate nohighlight">\(D\)</span> with apothem equal to 1.5 meters. The interior of <span class="math notranslate nohighlight">\(D\)</span> contains a scatterer (red and blue circles) and each side of the octagon consists of an individual speaker and its cabinet; the centered green boundary segments are speaker cones which comprise 0.875 of the total edge length and the black segments are the cabinet walls. To simplify the problem, we model the scatterer as a dense fluid and ignore the impedance of the speaker cabinet.</p>
<div class="math notranslate nohighlight">
\[\Delta u + \kappa^2 u = 0 \quad\text{in }D, \qquad\qquad\frac{\partial u}{\partial n} = \rho_0\omega\sum_{j=1}^8 \theta_j\chi_j \quad\text{on }\partial D\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa=\omega/c\)</span> is the wave number, <span class="math notranslate nohighlight">\(c\)</span> is the speed of sound, <span class="math notranslate nohighlight">\(\rho_0\)</span> is the fluid density, <span class="math notranslate nohighlight">\(\chi_j:\partial D\to\{0,1\}\)</span> is the characteristic function of the <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span> speaker cone (green boundary segments in the figure), and <span class="math notranslate nohighlight">\(\theta_j\)</span> is the acoustic velocity output by the <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span> speaker for <span class="math notranslate nohighlight">\(j=1,\ldots,8\)</span> — in other words, the <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span> speaker cone oscillates with velocity <span class="math notranslate nohighlight">\(\theta_j\cos(\omega t)\)</span>. In this example we assume that the material in the red circle is made of aluminum for which the speed of sound is 6320 m/s and that the regions in the blue circle and exterior to the red circle are comprised of air at <span class="math notranslate nohighlight">\(20^\circ\text{C}\)</span> which has a speed of sound of 343 m/s.  In addition, we set the frequency to be <span class="math notranslate nohighlight">\(f=400\)</span> Hz and the fluid density to be that of air at <span class="math notranslate nohighlight">\(20^\circ\text{C}\)</span> and standard atmospheric pressure, i.e. <span class="math notranslate nohighlight">\(\rho_0=1.204 \text{kg/m}^3\)</span>.</p>
<p>The benchmark consists of data from three experiments each consisting of measurements of the acoustic pressure data <span class="math notranslate nohighlight">\(u(x)\)</span>, at 5000 microphone locations <span class="math notranslate nohighlight">\(x\)</span>. For the high-fideliy experiment we set the speaker amplitudes as <span class="math notranslate nohighlight">\(\theta_{1,i}=1\)</span>, <span class="math notranslate nohighlight">\(i=1,\ldots,8\)</span> and for the low-fidelity experiments we set <span class="math notranslate nohighlight">\(\theta_{2,i}=1\)</span>, <span class="math notranslate nohighlight">\(i=3,5,7\)</span> and <span class="math notranslate nohighlight">\(\theta_{3,i}=3\)</span>, <span class="math notranslate nohighlight">\(i=2,4,6,8\)</span>; all other speaker amplitudes are set to zero. Speakers are ordered counter clockwise with the first speaker located on the right vertical edge of the octagon.</p>
<p>Under these conditions each information source</p>
<div class="math notranslate nohighlight">
\[u_1(x)=\sum_{i=1}^8 \phi_i(x)\theta_{1,i} \qquad   u_2(x)=\sum_{i=3,5,7} \phi_i(x)\theta_{2,i} \qquad   u_3(x)=\sum_{i=2,4,6,8} \phi_i(x)\theta_{3,i}\]</div>
<p>is a linear sum of basis functions <span class="math notranslate nohighlight">\(\phi_i(x)\)</span> which correspond to solving the Helmholtz equation using only one active speaker. Specifically the basis <span class="math notranslate nohighlight">\(\phi_i\)</span> is obtained by solving</p>
<div class="math notranslate nohighlight">
\[\Delta \phi + \kappa^2 \phi = 0 \quad\text{in }D,
\qquad\qquad\frac{\partial \phi}{\partial n} =  
\rho_0\omega\theta_i \quad\text{on }\partial D\]</div>
<p>The measurements of each experiment, taken at locations <span class="math notranslate nohighlight">\(x_k^{(i)}\)</span> in the domain <span class="math notranslate nohighlight">\(D\)</span>, are given by <span class="math notranslate nohighlight">\(y_k^{(i)}=u_k(x_k^{(i)})+\epsilon_k^{(i)}\)</span> for each information source <span class="math notranslate nohighlight">\(k=1,2,3\)</span>, where the noise <span class="math notranslate nohighlight">\(\epsilon_k^{(i)}\)</span> is normally distributed with mean zero and unit variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mesh_resolution</strong><span class="classifier">integer</span></dt><dd><p>Specifies the resolution of the finite element mesh</p>
</dd>
<dt><strong>noise_std</strong><span class="classifier">float</span></dt><dd><p>The standard deviation of the IID noise in the observations</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>benchmark</strong><span class="classifier">pya.Benchmark</span></dt><dd><p>Object containing the benchmark attributes documented below</p>
</dd>
<dt><strong>samples</strong><span class="classifier">list</span></dt><dd><p>List with entries np.ndarray (nvars,nsamples) which contain the 
locations <span class="math notranslate nohighlight">\(x_k^{(i)}\)</span> of the observations of each 
information source</p>
</dd>
<dt><strong>obs</strong><span class="classifier">list np.ndarray (nsamples,1)</span></dt><dd><p>List with entries np.ndarray (nsamples,1) containing the values of
the noisy observations <span class="math notranslate nohighlight">\(y_k^{(i)}\)</span> of each information source</p>
</dd>
<dt><strong>bases</strong><span class="classifier">np.ndarray (nsamples,8)</span></dt><dd><p>The basis functions <span class="math notranslate nohighlight">\(\phi_i\)</span> used to model the observations</p>
</dd>
<dt><strong>noise_std</strong><span class="classifier">float</span></dt><dd><p>The standard deviation of the IID noise in the observations. 
This is just the value passed in to this function, stored for 
convienience.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pyapprox.fenics_models.helmholtz_benchmarks.HelmholtzBasis.html" class="btn btn-neutral float-right" title="HelmholtzBasis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pyapprox.fenics_models.helmholtz_benchmarks.setup_helmholtz_model.html" class="btn btn-neutral float-left" title="setup_helmholtz_model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>